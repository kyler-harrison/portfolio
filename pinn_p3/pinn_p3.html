<!DOCTYPE html>
<html>
	<head>
		<title>PINNs Part 3: Solving the Hydrogen Atom Schrodinger Equation</title>
		<link href="../page.css" rel="stylesheet" type="text/css">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<script type="text/x-mathjax-config">
			MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
	  <script type="text/javascript"
       src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
	</head>
	<body>
		<ul class="nav-bar">
			<li class="nav-li nav-li-right"><a class="nav-a" href="../index.html">Kyler Harrison</a></li>
		</ul>
		<div class="content">
			<div class="title-container">
				<h1>PINNs Part 3: Solving the Hydrogen Atom Schrodinger Equation</h1>
				<p class="header-text">10/26/2025</p>
				<hr>
			</div>
			<div class="main-text-container">
				<p><b><mark>NOTE very incomplete rough draft</mark></b></p>
				<p>As described in <a href="../pinn_p2/pinn_p2.html" target="_blank">Part 2</a>, an atom consists of a nucleus and electron(s). The Hydrogen atom has one electron and we will apply the Schrodinger equation to that electron. I will then use a PINN to solve the equation.</p>
				<br>
				<h3>The Hydrogen atom Schrodinger equation</h3>
				<p>The Hamiltonian operator for Hydrogen is defined</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} \hat{H} = -\frac{\hbar^2}{2m}\nabla^2 + V(\vec{r}) , \end{eqnarray}$$</p>
				</div>
				<p>where $\nabla^2$ is the Laplace operator, $m$ is the mass of the electron, and $V(\vec{r})$ is the potential of the electron defined by</p> 
				<div class="eqn-box">
					<p>$$\begin{eqnarray} V(\vec{r}) = -\frac{e^2}{4 \pi \varepsilon_0 |\vec{r}|} , \end{eqnarray}$$</p>
				</div>
				<p>where $\vec{r}$ is the position of the electron in 3D cartesian coordinates, $e$ is the charge of the electron, and $\varepsilon_0$ is the permittivity of free space.</p>
				<p>Unlike the infinite square well differential equation, the Hydrogen atom Schrodinger has a non-zero potential term. This complicates the equation and makes it significantly harder to solve analytically.</p>
				<p>The full Schrodinger equation is</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} -\frac{\hbar^2}{2m} \left(\frac{\partial^2 \psi}{\partial x^2} + \frac{\partial^2 \psi}{\partial y^2} + \frac{\partial^2 \psi}{\partial z^2} \right) - \frac{e^2}{4 \pi \varepsilon_0 |\vec{r}|}\psi = E\psi . \end{eqnarray}$$</p>
				</div>
				<p>To solve this analytically, the equation must be expressed in spherical coorindates. Skipping some details, the Schrodinger equation becomes</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray}-\frac{\hbar^2}{2m} \left[\frac{1}{r^2} \frac{\partial}{\partial r} \left(r^2 \frac{\partial \psi}{\partial r} \right) + \frac{1}{r^2 sin \theta} \frac{\partial}{\partial \theta} \left(sin \theta \frac{\partial \psi}{\partial \theta} \right) + \frac{1}{r^2 sin^2 \theta} \left(\frac{\partial^2 \psi}{\partial \phi^2} \right) \right] - \frac{e^2}{4 \pi \varepsilon_0 r}\psi = E \psi . \end{eqnarray}$$</p>
				</div>
				<p>A separation of variables can be applied to this equation to break it down into a radial component, $R(r)$, and an angular component, $Y(\theta, \phi)$. This lets us express the wavefunction as</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray}\psi(r, \theta, \phi) = R(r) Y(\theta, \phi) , \end{eqnarray}$$</p>
				</div>
				<p>and gives two differential equations</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray}
						l(l + 1) &=& \frac{1}{R} \frac{d}{dr} \left(r^2 \frac{dR}{dr} \right) - \frac{2mr^2}{\hbar^2}[V(r) - E ] , \\
						-l(l + 1) &=& \frac{1}{Y} \left[\frac{1}{sin \theta} \frac{\partial}{\partial \theta} \left(sin \theta \frac{\partial Y}{\partial \theta} \right) + \frac{1}{sin^2 \theta} \frac{\partial^2 Y}{\partial \phi^2} \right] . 
						\end{eqnarray}$$</p>
				</div>
				<p>Finding the analytical solutions to $R$ and $Y$ involves a ton of steps that I won't go over. If you're interested in the entire solution, I encourage you to check out chapter 4 of <a href="https://doi.org/10.1017/9781316995433" target="_blank">Introduction to Quantum Mechanics (Third Edition) by David J. Griffiths and Darrell F. Schroeter</a> or <a href="https://www.youtube.com/watch?v=-Y0XL-K0jy0&list=PLjH5ujQJt_IeW2qFkDRIBrZpIgx4ZX4AR&index=3" target="_blank">Richard Behiel's YouTube series</a>.</p>
				<p>The analytical solution to $R$ is given by</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} 
						R_{nl}(r) = \sqrt{\left(\frac{2}{na}\right)^3 \frac{(n - l - 1)!}{2n(n + l)!}}e^{-r/na} \left(\frac{2r}{na}\right)^l \left[L^{2l + 1}_{n - l - 1}\left(\frac{2r}{na}\right)\right] ,
						\end{eqnarray}$$</p>
				</div>
				<p>where $a$ is the Bohr radius, and the associated Laguerre and Laguerre polynomials are defined as</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} 
						L^p_q(x) &\equiv&  (-1)^p \left(\frac{d}{dx}\right)^p  L_{p + q}(x) , \\ 
						L_q(x) &\equiv& \frac{e^x}{q!} \left(\frac{d}{dx}\right)^q (e^{-x}x^q) .
						\end{eqnarray}$$</p>
				</div>
				<p>The analytical solution to $Y$ is given by</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} 
						Y^m_l(\theta, \phi) = \sqrt{\frac{(2l + 1)(l - m)!}{4 \pi (l + m)!}} e^{im \phi} P^m_l(cos \theta) , 
						\end{eqnarray}$$</p>
				</div>
				<p>with the associated Legendre function and the Legendre polynomial defined as</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} 
						P^m_l(x) &\equiv& (-1)^m (1 - x^2)^{m/2} \left(\frac{d}{dx}\right)^m P_l(x) ,  \\
						P_l(x) &\equiv& \frac{1}{2^l l!} \left(\frac{d}{dx}\right)^l (x^2 - 1)^l ,
						\end{eqnarray}$$</p>
				</div>
				<p>and $n$, $l$, $m$ are quantum numbers (constants) introduced when solving for $R$ and $Y$.</p>
				<p>So, the full wavefunction for the Hydrogen atom is</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} 
						\psi_{nlm} = \sqrt{\left(\frac{2}{na}\right)^3 \frac{(n - l - 1)!}{2n(n + l)!}}e^{-r/na} \left(\frac{2r}{na}\right)^l \left[L^{2l + 1}_{n - l - 1}\left(\frac{2r}{na}\right)\right] \sqrt{\frac{(2l + 1)(l - m)!}{4 \pi (l + m)!}} e^{im \phi} P^m_l(cos \theta) , 
						\end{eqnarray}$$</p>
				</div>
				<p>with the energy eigenvalue (found when solving $R$),</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} E_n = -\left[\frac{m}{2 \hbar^2} \left(\frac{e^2}{4 \pi \varepsilon_0} \right)^2 \right] \frac{1}{n^2}. \end{eqnarray}$$</p>
				</div>
				<p>Easy!</p>
				<p>Clearly, this analytical solution is a steep jump in complexity compared to the simple sinusoid solution encountered in the infinite well problem discussed in <a href="../pinn_p2/pinn_p2.html" target="_blank">Part 2</a>. The Hydrogen atom is the only atom in the periodic table that can be (or at least, has been) solved analytically. All atoms with more electrons do not have analytical solutions and must be approximated through other numerical methods for predictions. Getting a PINN to solve the full 3D Hydrogen atom is such an interesting task to me because if successful, the methods could be extended to predict the wavefunctions and energy levels of multi-electron atoms.</p>
				<br>
				<h3>Units</h3>
				<p>Just like in <a href="../pinn_p2/pinn_p2.html" target="_blank">Part 2</a>, I will use Coulomb units in this problem. That means that I will set</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} \frac{\hbar^2}{2m} &=& \frac{1}{2}, \\ 
					                      \frac{e^2}{4 \pi \varepsilon_0} &=& 1, \\
										  E_n &=& -\frac{1}{2n^2}.
						\end{eqnarray}$$</p>
				</div>
				<p>The Bohr radius, $a_0$, is a physical constant approximately defined as the most probable distance between the nucleus and electron in the Hydrogen atom. In Coulomb units, the Bohr radius conveniently becomes</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} a_0 &=& \frac{4 \pi \varepsilon_0 \hbar^2}{m e^2} \\
						                      &=& \frac{\hbar^2}{mC} \\
											  &=& 1.
						\end{eqnarray}$$</p>
				</div>
				<p>So, the unit of length is equal to one Bohr radius.</p>
				<p>It took me an unreasonably long time to get these units right, and I observed an endless amount of bizarre PINN predictions as a consequence of not having consistent and correct units in my problem setup.</p>
				<br>
				<h3>Implementing a PINN to solve the 1D radial equation</h3>
				<p>In order to debug and check the validity of my units, I quickly implemented a PINN to predict the 1D radial equation solution. I didn't bother with scanning across $E$ values since I was just checking to see if I had a correct setup.</p>
				<p>The $R$ differential equation is solved analytically with the substitution $u(r) = rR(r)$, making it</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} -\frac{\hbar^2}{2m} \frac{d^2u}{dr^2} + \left[V(r) + \frac{\hbar^2}{2m} \frac{l(l+1)}{r^2} \right]u = Eu . \end{eqnarray}$$</p>
				</div>
				<p>In Coulomb units, the potential becomes $V(r)=-\frac{e^2}{4 \pi \varepsilon_0}\frac{1}{r}=-\frac{C}{r}=-\frac{1}{r}$. Thus, the radial equation can be expressed as</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} -\frac{1}{2} \frac{d^2u}{dr^2} + \left[-\frac{1}{r} + \frac{1}{2} \frac{l(l+1)}{r^2} \right]u = -\frac{1}{2n^2}u . \end{eqnarray}$$</p>
				</div>
				<p>For the analytical solutions to the radial equation please see page 2 of <a href="https://faculty.washington.edu/seattle/physics441/ch10b.pdf" target="_blank">this text</a> or see chapter 4 of Griffiths.</p>
				<p>This differential equation has a similar form to the 1D infinite square well differential equation. For simplicity's sake, I will set $l=0$. $f$ is defined by moving all terms to one side</p> 
				<div class="eqn-box">
					<p>$$\begin{eqnarray} f = -\frac{1}{2} \frac{d^2u}{du^2} - u \left( \frac{1}{r} + E \right).\end{eqnarray}$$</p>
				</div>
				<p>$L_f$ is defined in the same way as in <a href="../pinn_p2/pinn_p2.html">Part 2</a> and I use the parametric scaling function to handle boundary conditions again.</p>
				<p>Data generation simply requires the creation of values $r \in [r_{min}, r_{max}]$ where $r_{min}$ and $r_{max}$ are the defined minimum and maximum radii of the system, respectively, and a fixed step size of $\delta_r = 0.01$ is used.</p>
				<p>With the correct system of units finally determined, the first three analytical $E_n$ values were set and the PINN was trained for 10,000 training steps on each $E_n$. A simple feedforward architecture with sine activation functions was used again. The PINN attained the following $L_f$ values and predicted the first three wavefunctions with decent accuracy.</p>
				<div class="img-container">
					<img src="assets/R_loss_f.png">
					<br>
					<div>$L_f$ across training on $E_1$, $E_2$, $E_3$.</div>
				</div>
				<br>
				<br>
				<div class="img-container">
					<img src="assets/R_n=1.png">
					<br>
					<div>$n=1$ predictions and analytical solution.</div>
				</div>
				<br>
				<br>
				<div class="img-container">
					<img src="assets/R_n=2.png">
					<br>
					<div>$n=2$ predictions and analytical solution.</div>
				</div>
				<br>
				<br>
				<div class="img-container">
					<img src="assets/R_n=3.png">
					<br>
					<div>$n=3$ predictions and analytical solution.</div>
				</div>
				<br>
				<p>The PINN's predicted solutions attain $L_f$ values on the order of $10^{-4}$ to $10^{-3}$ and MSE values of $10^{-5}$ to $10^{-1}$. I believe better accuracy could be obtained with more training steps, but again, this was just a spot check to see if I had my units system defined correctly. My main focus is getting a PINN to solve the 3D equation.</p>
				<p>The code implementation for this problem can be found in <a href="https://github.com/kyler-harrison/Schrodinger-PINNs/blob/main/1D_H/H_1D_radial_eqn.ipynb" target="_blank">this repo</a>.</p>
				<br>
				<h3>Implementing a PINN to solve the full 3D equation</h3>
				<p>Although the analytical solution is found in spherical coordinates, I trained the PINN to learn to solve the cartesian form of the Hydrogen Schrodinger equation. Qualitatively, the cartesian form <i>just looks easier</i>, and more importantly, I couldn't get a PINN to converge to good results on the spherical form, but I could get good results using the cartesian form.</p>
				<p>From the Schrodinger equation, we can write</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} f = E \psi  + \frac{\hbar^2}{2m} \left(\frac{\partial^2 \psi}{\partial x^2} + \frac{\partial^2 \psi}{\partial y^2} + \frac{\partial^2 \psi}{\partial z^2} \right) + \frac{e^2}{4 \pi \varepsilon_0 \sqrt{x^2+y^2+z^2}}\psi . \end{eqnarray}$$</p>
				</div>
				<p>Once again, I encountered issues with handling boundary conditions with the parametric scaling function, so I went back to defining collocation and boundary condition sets of data.</p>
				<p>In the infinite well problem, I modeled 3D space with a cube of data. I experimented with generating a sphere of data for this problem since the known analytical solution is spherical. The PINN was able to learn correct solutions on data generated as a cube and a sphere, but I ultimately decided that the sphere data gave better results because the distribution of generated radii included more relevant points.</p>
				<p>The sphere of data included 20,480 data points (90% in collocation, 10% in b.c.).</p>
				<div class="img-container">
					<img src="assets/coll_sphere.png">
					<br>
					<div>Sphere of collocation training data.</div>
				</div>
				<br>
				<br>
				<div class="img-container">
					<img src="assets/bc_sphere.png">
					<br>
					<div>Sphere of boundary condition training data.</div>
				</div>
				<br>
				<p>Using a sphere of data requires a change in the calculation of the prediction normalization constant. The calculation follows the same logic as previous prediction normalization constant calculations, but approximates a 3D integral in spherical coordinates instead. This change makes the calculation a little trickier, but it's still manageable.</p>
				<p>First, the normalization condition says that</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} \int_0^{\pi} \int_0^{2\pi} \int_0^{\infty} | \psi |^2 r^2 sin\theta drd\theta d\phi &=& 1 .\end{eqnarray}$$</p>
				</div>
				<p>We approximate the integral with dimensional small steps of $\delta_r$, $\delta_{\theta}$, $\delta_{\phi}$,</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} \sum_{\phi=0}^{\pi} \sum_{\theta=0}^{2\pi} \sum_{r=0}^{r_{max}} | \psi |^2 r^2 sin\theta \delta_r \delta_{\theta} \delta_{\phi} &\approx& 1. \end{eqnarray}$$</p>
				</div>
				<p>Making the assumption that</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} \psi = c \hat{\psi} , \end{eqnarray}$$</p>
				</div>
				<p>we find that the prediciton normalization constant is</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} c = \frac{1}{\sqrt{\sum_{\phi=0}^{\pi} \sum_{\theta=0}^{2\pi} \sum_{r=0}^{r_{max}} | \hat{\psi} |^2 r^2 sin\theta \delta_r \delta_{\theta} \delta_{\phi}}}. \end{eqnarray}$$</p>
				</div>
				<p>This constant depends on $r$ and $\theta$, whereas the 3D infinite well problem only depended on fixed step sizes in $x$, $y$, and $z$. In practice, this just means that the input $r$ and $\theta$ for each prediction $\hat{\psi}$ are needed.</p>
				<p>The overall loss was again defined as</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} L_{ovr} = L_f + L_{bc} + L_{trivial}.\end{eqnarray}$$</p>
				</div>
				<p>The "correctness" of each PINN is defined by the loss without the non-trivial loss term ("loss_ovr_no_reg" in the plot below)</p>
				<div class="eqn-box">
					<p>$$\begin{eqnarray} L = L_f + L_{bc} .\end{eqnarray}$$</p>
				</div>
				<p>I trained this PINN to search over the first three analytical $E$ values. I searched across three values for each $E$ and saved the three best PINNs.</p>
				<div class="img-container">
					<img src="assets/l_ovr_no_reg.png">
					<br>
					<div>$L$ across training.</div>
				</div>
				<br>
				<br>
				<div class="img-container">
					<img src="assets/l_f.png">
					<br>
					<div>$L_f$ across training.</div>
				</div>
				<br>
				<br>
				<div class="img-container">
					<img src="assets/l_bc.png">
					<br>
					<div>$L_{bc}$ across training.</div>
				</div>
				<br>
				<br>
				<div class="img-container">
					<img src="assets/E.png">
					<br>
					<div>$E$ across training.</div>
				</div>
				<br>
				<p>As I'd hoped, the best PINN convergence occurred when the correct analytical $E$ values were used as inputs: $E_1=-0.5$, $E_2=-0.125$, $E_3=-0.056$. Although the best PINNs used the correct $E$ values, the difference between $L$ across the adjacent $E$ values is not very significant (only an order of magnitude for each PINN).</p>
				<p>To visualize the solutions, I plot the square of the wavefunction's magnitude (effectively the probability density), $|\hat{\psi}(x, y, z)|^2$, for each $x$, $y$, $z$ in the sphere of data. I also cut a slice of the sphere away so you can see the distribution of predictions. The PINN can only converge to one of potentially many degenerate solutions for each energy level, so I pair the predictions up with the corresponding $nlm$ degenerate analytical solution below.</p>
				<div class="img-container">
					<img src="assets/n=1_pred.png">
					<br>
					<div>$n=1$ predictions.</div>
				</div>
				<br>
				<br>
				<div class="img-container">
					<img src="assets/n=1_an.png">
					<br>
					<div>$nlm=100$ analytical solution.</div>
				</div>
				<br>
				<br>
				<div class="img-container">
					<img src="assets/n=2_pred.png">
					<br>
					<div>$n=2$ predictions.</div>
				</div>
				<br>
				<br>
				<div class="img-container">
					<img src="assets/n=2_an.png">
					<br>
					<div>$nlm=200$ analytical solution.</div>
				</div>
				<br>
				<br>
				<div class="img-container">
					<img src="assets/n=3_pred.png">
					<br>
					<div>$n=3$ predictions.</div>
				</div>
				<br>
				<br>
				<div class="img-container">
					<img src="assets/n=3_an.png">
					<br>
					<div>$nlm=320$ analytical solution.</div>
				</div>
				<br>
				<br>
				<p><b>TODO</b> discussion of results, finalized code, next steps</p>
				<br>
            </div>
		</div>
	</body>
</html>
